# 数据提取配置文件
version: "1.0"
description: "基于数据特性和时效性重新组织的股票数据提取配置"

# 全局配置
global_config:
  timeout: 30
  retry_count: 3
  enable_cache: true
  default_cache_duration: 300  # 5分钟默认缓存
  log_level: "INFO"

# 标准字段定义 - 定义每种数据类型最终保留的字段
standard_fields:
  static_info:
    basic_info:
      - symbol            # 股票代码
      - name              # 股票名称
      - market            # 市场
      - list_date         # 上市日期
      - industry          # 行业
      - concept           # 概念名称
      - totals            # 总股本
      - outstanding       # 流通股本
      - main_business     # 主营业务
      - index_membership  # 入选指数成员

  market_data:
    # 日线行情数据
    daily_quote:
      - symbol          # 股票代码
      - date            # 日期
      - open            # 开盘价
      - high            # 最高价
      - low             # 最低价
      - close           # 收盘价
      - volume          # 成交量
      - amount          # 成交额
      - pct_change      # 涨跌幅
      - change          # 涨跌额
      - turnover_rate   # 换手率
      - amplitude       # 振幅
    
    # 融资融券数据
    margin_trading:
      - symbol              # 股票代码
      - date                # 日期
      - margin_balance      # 融资余额
      - margin_buy_amount   # 融资买入额
      - margin_repay_amount # 融资偿还额
      - short_balance       # 融券余量
      - short_sell_amount   # 融券卖出量
      - short_repay_amount  # 融券偿还量

    # 筹码分布数据
    chip_distribution:
      - symbol              # 股票代码
      - date                # 日期
      - profit_ratio        # 获利比例
      - avg_cost            # 平均成本
      - cost_90_low         # 90%成本区间下限
      - cost_90_high        # 90%成本区间上限
      - concentration_90    # 90%集中度
      - cost_70_low         # 70%成本区间下限
      - cost_70_high        # 70%成本区间上限
      - concentration_70    # 70%集中度

    # 资金流向数据
    fund_flow:
      - symbol              # 股票代码
      - date                # 日期
      - close_price         # 最新价
      - pct_change          # 涨跌幅
      - turnover_rate       # 换手率
      - inflow_amount       # 流入资金
      - outflow_amount      # 流出资金
      - net_amount          # 净流入金额
      - total_amount        # 成交额

    # 大宗交易数据
    block_trading:
      - symbol              # 股票代码
      - date                # 交易日期
      - close_price         # 收盘价
      - pct_change          # 涨跌幅
      - trade_price         # 成交价
      - discount_rate       # 折溢率
      - trade_count         # 成交笔数
      - trade_volume        # 成交总量
      - trade_amount        # 成交总额
      - amount_ratio        # 成交额占比

    # 龙虎榜数据
    dragon_tiger_list:
      - symbol              # 股票代码
      - date                # 上榜日期
      - close_price         # 收盘价
      - pct_change          # 涨跌幅
      - net_buy_amount      # 龙虎榜净买额
      - buy_amount          # 龙虎榜买入额
      - sell_amount         # 龙虎榜卖出额
      - total_amount        # 龙虎榜成交额
      - net_ratio           # 净买额占比
      - reason              # 上榜原因
      - after_1d            # 上榜后1日表现
      - after_5d            # 上榜后5日表现

    # 沪深港通持股数据
    hsgt_holding:
      - symbol              # 股票代码
      - date                # 日期
      - close_price         # 收盘价
      - pct_change          # 涨跌幅
      - holding_quantity    # 持股数量
      - holding_value       # 持股市值
      - holding_ratio       # 持股比例
      - daily_increase_qty  # 当日增持股数
      - daily_increase_amt  # 当日增持金额
      - value_change        # 持股市值变化

    stock_sentiment:
      - symbol              # 股票代码
      - date                # 日期
      - vote_bullish_count  # 看涨数量
      - vote_bearish_count  # 看跌数量
      - vote_bullish_ratio  # 看涨比例
      - vote_bearish_ratio  # 看跌比例
      - comment_count       # 评论数量
      - sentiment_score     # 情绪得分
      - sentiment_type      # 情绪类型（乐观/悲观/中性）
      - data_source         # 数据来源

    stock_news:
      - symbol              # 股票代码
      - news_id             # 新闻ID
      - title               # 新闻标题
      - content             # 新闻内容
      - publish_time        # 发布时间
      - news_source         # 新闻来源
      - news_type           # 新闻类型
      - importance_level    # 重要程度
      - sentiment_score     # 情绪得分
      - related_stocks      # 相关股票

  financial_data:
    # 资产负债表数据（按报告期）
    balance_sheet:
      - symbol              # 股票代码
      - report_date         # 报告期
      - report_type         # 报告类型（年报/中报/一季报/三季报）
      - report_period       # 报告期间（如2024-12-31, 2024-06-30等）
      - total_assets        # 资产总计
      - current_assets      # 流动资产
      - non_current_assets  # 非流动资产
      - total_liabilities   # 负债合计
      - current_liabilities # 流动负债
      - non_current_liabilities # 非流动负债
      - shareholder_equity  # 股东权益合计
      - cash_deposits       # 货币资金
      - accounts_receivable # 应收账款
      - inventory           # 存货
      - fixed_assets        # 固定资产
      - intangible_assets   # 无形资产
      - goodwill           # 商誉
    
    # 利润表数据（按报告期）
    income_statement:
      - symbol                    # 股票代码
      - report_date              # 报告期
      - report_type              # 报告类型（年报/中报/一季报/三季报）
      - report_period            # 报告期间
      - total_operating_income   # 营业总收入
      - operating_income         # 营业收入
      - total_operating_cost     # 营业总成本
      - operating_cost           # 营业成本
      - sales_expense            # 销售费用
      - management_expense       # 管理费用
      - research_expense         # 研发费用
      - finance_expense          # 财务费用
      - operating_profit         # 营业利润
      - total_profit             # 利润总额
      - net_profit               # 净利润
      - parent_net_profit        # 归属于母公司净利润
      - non_recurring_profit     # 扣非净利润
    
    # 现金流量表数据（按报告期）
    cash_flow:
      - symbol                   # 股票代码
      - report_date             # 报告期
      - report_type             # 报告类型（年报/中报/一季报/三季报）
      - report_period           # 报告期间
      - operating_cash_inflow   # 经营活动现金流入
      - operating_cash_outflow  # 经营活动现金流出
      - operating_cash_flow     # 经营活动现金流量净额
      - investing_cash_flow     # 投资活动现金流量净额
      - financing_cash_flow     # 筹资活动现金流量净额
      - net_cash_increase       # 现金及现金等价物净增加额

    # 财务指标数据（按报告期）
    financial_indicators:
      - symbol                  # 股票代码
      - report_date            # 报告期
      - report_type            # 报告类型（年报/中报/一季报/三季报）
      - report_period          # 报告期间
      - net_profit_growth      # 净利润同比增长率
      - operating_income_growth # 营业总收入同比增长率
      - eps                    # 基本每股收益
      - bps                    # 每股净资产
      - net_profit_margin      # 销售净利率
      - gross_profit_margin    # 销售毛利率
      - roe                    # 净资产收益率
      - current_ratio          # 流动比率
      - quick_ratio            # 速动比率
      - debt_to_asset_ratio    # 资产负债率
      - inventory_turnover     # 存货周转率
      - receivables_turnover   # 应收账款周转率

    # 分红送配数据（按报告期）
    dividend_info:
      - symbol                 # 股票代码
      - report_date           # 报告期
      - report_type           # 报告类型（年报/中报/一季报/三季报）
      - report_period         # 报告期间
      - stock_dividend_ratio  # 送转股份比例
      - cash_dividend_ratio   # 现金分红比例
      - dividend_yield        # 股息率
      - ex_dividend_date      # 除权除息日
      - record_date           # 股权登记日
      - payment_date          # 分红发放日
      - dividend_status       # 方案进度

  market_macro:
    market_overview:
      - symbol          # 股票代码
      - date            # 日期
      - market_cap      # 总市值
      - circulating_cap # 流通市值
      - turnover_rate   # 换手率
      - pe              # 平均市盈率
      - pb              # 平均市净率

    market_indices:
      - symbol          # 股票代码
      - date            # 日期
      - index_code      # 指数代码
      - index_name      # 指数名称
      - open            # 开盘点数
      - high            # 最高点数
      - low             # 最低点数
      - close           # 收盘点数
      - volume          # 成交量
      - amount          # 成交额
      - pct_change      # 涨跌幅
    
    sector_concept:
      - sector_code         # 板块代码
      - sector_name         # 板块名称
      - sector_type         # 板块类型（行业/概念）
      - date                # 日期
      - open_price          # 开盘价
      - high_price          # 最高价
      - low_price           # 最低价
      - close_price         # 收盘价
      - volume              # 成交量
      - amount              # 成交额
      - pct_change          # 涨跌幅
      - change              # 涨跌额
      - turnover_rate       # 换手率
      - net_inflow          # 净流入资金
      - net_inflow_ratio    # 净流入占比
      - stock_count         # 成分股数量
      - leading_stocks      # 领涨股票

    market_activity:
      - date                # 日期
      - market_type         # 市场类型（A股/港股/美股）
      - activity_index      # 活跃度指数
      - trading_volume      # 总成交量
      - trading_amount      # 总成交额
      - stock_count         # 交易股票数量
      - limit_up_count      # 涨停股票数量
      - limit_down_count    # 跌停股票数量
      - avg_turnover_rate   # 平均换手率
      - market_heat_level   # 市场热度等级


# 数据分类配置
data_categories:
  # 静态基础信息类（与日期无关，相对稳定）
  static_info:
    description: "股票基础信息，相对稳定，变化频率低"
    cache_duration: 86400  # 24小时缓存
    retry_strategy: "conservative"
    
    data_types:
      stock_basic_info:
        description: "股票基本信息（代码、名称、上市日期等）"
        interfaces:
          - name: "stock_info_sz_name_code"
            priority: 2
          - name: "stock_info_sh_name_code" 
            priority: 1
          - name: "stock_a_code_to_symbol"
            priority: 0
            
      company_profile:
        description: "公司概况信息"
        interfaces:
          - name: "stock_individual_info_em"
            priority: 1
          - name: "stock_profile_cninfo"
            priority: 0
            
      industry_classification:
        description: "行业分类信息"
        interfaces:
          - name: "stock_board_industry_name_em"
            priority: 1
          - name: "stock_board_concept_name_ths"
            priority: 0

  # 动态行情数据类（每日/实时变化）
  market_data:
    description: "实时和历史行情数据，变化频率高"
    cache_duration: 300    # 5分钟缓存
    retry_strategy: "aggressive"
    
    data_types:
      realtime_quote:
        description: "实时行情数据"
        interfaces:
          - name: "stock_zh_a_spot"
            enabled: false  # 暂时禁用，因为接口有问题
            priority: 1
          - name: "stock_zh_a_hist"  # 使用历史数据作为替代
            priority: 0
        
      historical_quote:
        description: "历史行情数据"
        interfaces:
          - name: "stock_zh_a_hist"
            priority: 2
          - name: "stock_zh_a_daily"
            priority: 1
          - name: "stock_zh_a_hist_tx"
            priority: 0
            
      intraday_data:
        description: "分时数据"
        interfaces:
          - name: "stock_intraday_em"
            priority: 1
          - name: "stock_zh_a_minute"
            priority: 0

  # 周期性财务数据类（按报告期更新）
  financial_data:
    description: "财务报表和指标，按季度/年度更新"
    cache_duration: 3600   # 1小时缓存
    retry_strategy: "standard"
    
    data_types:
      financial_statements:
        description: "财务报表数据"
        interfaces:
          - name: "stock_balance_sheet_by_report_em"
            priority: 2
          - name: "stock_profit_sheet_by_report_em"
            priority: 1
          - name: "stock_cash_flow_sheet_by_report_em"
            priority: 0
            
      financial_indicators:
        description: "财务指标"
        interfaces:
          - name: "stock_financial_abstract_ths"
            priority: 1
          - name: "stock_financial_hk_report_em"
            priority: 0
            
      dividend_info:
        description: "分红配股信息"
        interfaces:
          - name: "stock_dividend_cninfo"
            priority: 1
          - name: "stock_fhps_detail_em"
            priority: 0

  # 技术分析数据类（基于历史数据计算）
  technical_data:
    description: "技术指标和分析数据"
    cache_duration: 1800   # 30分钟缓存
    retry_strategy: "standard"
    
    data_types:
      technical_indicators:
        description: "技术指标"
        interfaces:
          - name: "stock_a_gxl_lg"
            priority: 1
          - name: "stock_buffett_index_lg"
            priority: 0
            
      market_sentiment:
        description: "市场情绪指标"
        interfaces:
          - name: "stock_comment_em"
            priority: 1
          - name: "stock_comment_detail_scrd_desire_em"
            priority: 0

  # 市场宏观数据类（市场整体信息）
  market_macro:
    description: "市场整体和宏观数据"
    cache_duration: 1800   # 30分钟缓存
    retry_strategy: "standard"
    
    data_types:
      market_indices:
        description: "市场指数"
        interfaces:
          - name: "stock_zh_index_daily"
            priority: 1
          - name: "stock_zh_index_daily_tx"
            priority: 0
        
      market_overview:
        description: "市场概览"
        interfaces:
          - name: "stock_market_activity_legu"
            priority: 1
          - name: "stock_account_statistics_em"
            priority: 0

  # 特殊数据类（特定用途）
  special_data:
    description: "特殊用途和其他数据"
    cache_duration: 7200   # 2小时缓存
    retry_strategy: "conservative"
    
    data_types:
      research_reports:
        description: "研究报告"
        interfaces:
          - name: "stock_analyst_rank_em"
            priority: 1
          - name: "stock_analyst_detail_em"
            priority: 0
            
      news_events:
        description: "新闻事件"
        interfaces:
          - name: "stock_news_em"
            priority: 0
            
      other_data:
        description: "其他数据"
        interfaces:
          - name: "stock_add_stock"
            enabled: false  # 暂时禁用，因为接口有问题
            priority: 4
          - name: "stock_classify_sina"
            enabled: false  # 暂时禁用，因为接口有问题
            priority: 3
          - name: "stock_board_concept_name_ths"  # 同花顺概念板块
            priority: 2
          - name: "stock_industry_category_cninfo"  # 巨潮行业分类
            priority: 1
          - name: "stock_dividend_cninfo"  # 巨潮分红数据
            priority: 0

# 字段映射配置 - 所有接口共用
field_mappings:
  # 中文字段名到英文标准字段名的映射
  "代码": "symbol"
  "股票代码": "symbol"
  "证券代码": "symbol"
  "名称": "name"
  "股票名称": "name"
  "股票简称": "name"
  "证券名称": "name"
  "市场": "market"
  "交易所": "market"
  "上市日期": "list_date"
  "挂牌日期": "list_date"
  "行业": "industry"
  "所属行业": "industry"
  "申万行业": "industry"
  "地区": "area"
  "所在地区": "area"
  "注册地": "area"
  "最新价": "price"
  "现价": "price"
  "当前价": "price"
  "涨跌额": "change"
  "涨跌": "change"
  "涨跌幅": "pct_change"
  "涨幅": "pct_change"
  "成交量": "volume"
  "成交额": "amount"
  "最高": "high"
  "最高价": "high"
  "最低": "low"
  "最低价": "low"
  "今开": "open"
  "开盘": "open"
  "开盘价": "open"
  "昨收": "pre_close"
  "前收盘": "pre_close"
  "昨日收盘价": "pre_close"
  "收盘": "close"
  "收盘价": "close"
  "日期": "date"
  "交易日期": "date"
  "时间": "time"
  "交易时间": "time"
  "市盈率": "pe"
  "PE": "pe"
  "市净率": "pb"
  "PB": "pb"
  "总市值": "market_cap"
  "流通市值": "circulating_cap"
  "换手率": "turnover_rate"
  "流通股本": "outstanding"
  "总股本": "totals"
  "主营业务": "main_business"
  "董事长": "chairman"
  "员工人数": "employees"
  "员工数": "employees"
  "总资产": "total_assets"
  "净利润": "net_profit"
  "营业收入": "revenue"
  "营业总收入": "total_revenue"
  "负债合计": "total_liabilities"
  "股东权益合计": "shareholders_equity"
  "报告期": "report_date"
  "公告日期": "announce_date"
  "分红日期": "dividend_date"
  "现金分红": "cash_dividend"
  "每股收益": "eps"
  "每股净资产": "bvps"
